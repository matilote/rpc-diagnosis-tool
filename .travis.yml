language: csharp
mono: none
sudo: required
os: osx

jobs:
  include:
    - stage: rocksdb test   
      script: |
        git clone git://github.com/Cyan4973/lz4.git
        brew install gcc
        brew install snappy
        brew install zstd
        make -C lz4/lib
        cp -L lz4/lib/liblz4.dylib ./liblz4_64.dylib
        make -C lz4/lib clean
        CFLAGS="-arch x86_64" CXXFLAGS="-arch x86_64" LDFLAGS="-arch x86_64" make -C lz4/lib
        lipo -create ./liblz4_64.dylib -output ./liblz4.dylib
        cp -v ./liblz4.dylib lz4/lib/$(readlink lz4/lib/liblz4.dylib)
        touch lz4/lib/liblz4
        make -C lz4/lib install
        git clone https://github.com/facebook/rocksdb.git
        cd rocksdb/
        git checkout v6.4.6
        make shared_lib
        cd /usr/local/lib/
        ls
        cp librocksdb.6.4.6.dylib librocksdb-6.4.6.dylib 
      name: "RocksDB OSX Build"